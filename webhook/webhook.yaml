apiVersion: webhookconfig.keptn.sh/v1alpha1
kind: WebhookConfig
metadata:
  name: webhook-configuration
spec:
  webhooks:
    - type: sh.keptn.event.github-action-silent.triggered
      sendFinished: true
      requests:
        - "curl --header 'Authorization: token
          {{.env.secret_githubsecret_GITHUBTOKEN}}' --request POST --data
          '{\"event_type\":\"silent\",\"client_payload\":{\"type\":\"{{.type}}\
          \",\"project\":\"{{.data.project}}\",\"service\":\"{{.data.service}}\
          \",\"stage\":\"{{.data.stage}}\",\"shkeptncontext\":\"{{.shkeptnconte\
          xt}}\",\"id\":\"{{.id}}\"}}'
          https://api.github.com/repos/dt-alliances/ca-demo-github/dispatches"
      envFrom:
        - name: secret_githubsecret_GITHUBTOKEN
          secretRef:
            name: github-secret
            key: GITHUBTOKEN
      subscriptionID: 5eebbb8d-42eb-4d9c-9405-c3fe864289f6
    - type: sh.keptn.event.github-action-interactive.triggered
      requests:
        - "curl --header 'Authorization: token
          {{.env.secret_githubsecret_GITHUBTOKEN}}' --request POST --data
          '{\"event_type\":\"interactive\",\"client_payload\":{\"type\":\"{{.ty\
          pe}}\",\"project\":\"{{.data.project}}\",\"service\":\"{{.data.servic\
          e}}\",\"stage\":\"{{.data.stage}}\",\"shkeptncontext\":\"{{.shkeptnco\
          ntext}}\",\"id\":\"{{.id}}\",\"custom-interactive-attribute\":\"custo\
          m-interactive-value\"}}'
          https://api.github.com/repos/dt-alliances/ca-demo-github/dispatches"
      envFrom:
        - name: secret_githubsecret_GITHUBTOKEN
          secretRef:
            name: github-secret
            key: GITHUBTOKEN
      subscriptionID: 867d0a56-69ef-4dde-87c3-264e81a14362
    - type: sh.keptn.event.create-jira.triggered
      requests:
        - "curl --header 'Content-type: application/json' --request POST --data
          '{\"event\":\"{{.type}}\",\"project\":\"{{.data.project}}\",\"service\
          \":\"{{.data.service}}\",\"stage\":\"{{.data.stage}}\",\"shkeptnconte\
          xt\":\"{{.shkeptncontext}}\",\"id\":\"{{.id}}\"}'
          https://automation.atlassian.com/pro/hooks/{{.env.secret_jirawebhook_\
          id}}"
      envFrom:
        - name: secret_jirawebhook_id
          secretRef:
            name: jirawebhook
            key: id
      subscriptionID: 0dada9e6-745e-4cdb-9377-75b01120b442
    - type: sh.keptn.event.update-jira.triggered
      requests:
        - curl --request POST --data
          '{"event":"{{.type}}","project":"{{.data.project}}","service":"{{.data.service}}","stage":"{{.data.stage}}","shkeptncontext":"{{.shkeptncontext}}","id":"{{.id}}","create-jira":{"url":".data.create-jira.url","key":".data.create-jira.key","summary":".data.create-jira.summary"}}'
          https://automation.atlassian.com/pro/hooks/59be362105d3daff7e9de49a0ac2dadb2c3cc8ae
      subscriptionID: 38cf2d1a-0c85-4181-b9d6-05d41954a639
